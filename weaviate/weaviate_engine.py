import weaviate
import weaviate.classes as wvc

client = weaviate.connect_to_local(
    host= "localhost",
    port = 8080,
    )

songs = client.collections.get("Song")

#Listened song's vector
query_vector = [151.99908088235293, -7.117506504058838, 68.59352111816406, -8.803194999694824, 19.5316162109375, 1.7185488939285278, 0.38923537731170654, 1.696270227432251, 6.016934394836426, -3.8661985397338867, 6.264878273010254, -3.65698504447937, 2.5377862453460693, -2.7983884811401367, 1.3864634037017822, -2.7227354049682617, -2.8279218673706055, -4.551302433013916, 0.6624278426170349, -4.031591415405273, 3.102125406265259, 2936.56093198943]
#query_vector = [135.99917763157896, -92.55733489990234, 93.97085571289062, 23.648523330688477, 22.020475387573242, -0.7324539422988892, 13.72374439239502, -0.009228481911122799, 3.8996288776397705, -5.710794448852539, 4.624973297119141, -3.4583966732025146, 0.2585993707180023, -0.9882120490074158, 0.9719424843788147, -3.422652006149292, 1.8519771099090576, 0.44094327092170715, 3.5445797443389893, 1.2994199991226196, 3.076815366744995, 2184.1922457724822]

response = songs.query.near_vector(
    near_vector=query_vector,
    limit=4,  # Adjust the limit as needed
    return_metadata=wvc.query.MetadataQuery(certainty=True)
)
song_title = "Speedy_Boy"

# Extract and print song names and certainty scores
similar_songs = [(obj.properties['title'], obj.metadata.certainty) for obj in response.objects]
for title, certainty in similar_songs[1:]:
    print(f"Song: {title}, Certainty: {certainty}")

client._connection.close()